#  Proyecto ETL SECOP

Este proyecto implementa un flujo completo de extracci贸n, transformaci贸n y carga (ETL) sobre los datos abiertos de contrataci贸n p煤blica publicados en el portal oficial [datos.gov.co](https://www.datos.gov.co), espec铆ficamente desde el dataset del **SECOP II** (Sistema Electr贸nico de Contrataci贸n P煤blica).

El objetivo principal es construir una base de datos robusta, confiable y estructurada que permita analizar la contrataci贸n estatal, identificar patrones, generar alertas o alimentar modelos anal铆ticos.

---

##  Objetivo General

Desarrollar un proceso automatizado en PySpark para:

- Descargar datos del SECOP II de manera eficiente y segura.
- Generar identificadores 煤nicos para los contratos.
- Detectar duplicados y asegurar consistencia estructural.
- Almacenar la informaci贸n en tablas Delta optimizadas para an谩lisis.

---

##  Estructura del Proceso

### 1.  Configuraci贸n Inicial

- Se importa la librer铆a oficial de Socrata (`sodapy`) para conectarse a la API de datos abiertos de Colombia.
- Se utilizan widgets interactivos para seleccionar din谩micamente el `dataset_id` deseado.
- Se configuran los par谩metros de autenticaci贸n y el n煤mero de registros por lote (`limit = 500000`).

---

### 2.  Descarga de Datos por Lotes

- El proceso de extracci贸n se realiza mediante paginaci贸n (`offset`) y control de errores con reintentos (`try/except`).
- Cada lote descargado se convierte en un DataFrame de Spark y se almacena en una tabla Delta temporal:  
  **`main.diplomado_datos.secop_restante_tmp`**
- El ciclo se repite hasta agotar los registros del dataset.

---

### 3.  Unificaci贸n y Limpieza de Datos

- Se leen los datos previamente cargados desde la tabla `secop_bronze` y se combinan con los nuevos registros descargados (`secop_restante_tmp`).
- Se eliminan registros duplicados usando `dropDuplicates` sobre las columnas clave:  
  `['codigo_proceso', 'nombre_entidad', 'objeto_contrato', 'valor_total', 'fecha_firma']`

---

### 4.  Generaci贸n de Identificador nico (`id_sha2`)

- Se crea un nuevo campo `id_sha2` aplicando la funci贸n `sha2` (hash SHA-256) sobre la concatenaci贸n de campos relevantes

##  Datasets Utilizados

Los siguientes conjuntos de datos p煤blicos fueron utilizados:

- **Contrataci贸n P煤blica (SECOP II):**
  - URL: [https://www.datos.gov.co/resource/rpmr-utcd.csv](https://www.datos.gov.co/resource/rpmr-utcd.csv)
  - Descripci贸n: Contiene informaci贸n sobre los contratos registrados en el Sistema Electr贸nico para la Contrataci贸n P煤blica.

- **Matr铆cula Oficial en Educaci贸n (MEN):**
  - URL: [https://www.datos.gov.co/resource/nudc-7mev.csv](https://www.datos.gov.co/resource/nudc-7mev.csv)
  - Descripci贸n: Reporte oficial de matr铆culas escolares por municipio y nivel educativo.


##  Instrucciones para Ejecutar el Proyecto

1. Clona este repositorio:
   ```bash
   git clone https://github.com/MarianaCelisBougard/databricks_versionfinal
   cd tu_repositorio
